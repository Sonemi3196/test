<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÎèÖÎèÑ Î∞©Ïñ¥ Í≤åÏûÑ</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap');
        body {
            font-family: 'Noto Sans KR', sans-serif;
            margin: 0;
            padding: 0;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;
        
        const Play = ({ size = 20 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="currentColor">
                <polygon points="5,3 19,12 5,21" />
            </svg>
        );
        
        const RotateCcw = ({ size = 20 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <polyline points="1,4 1,10 7,10" />
                <path d="M3.51,15a9,9,0,0,0,13.83-6.36A9,9,0,0,0,3.51,15Z" />
            </svg>
        );

        const DokdoDefenseGame = () => {
            const [score, setScore] = useState(500);
            const [timeLeft, setTimeLeft] = useState(20);
            const [stage, setStage] = useState(1);
            const [gameStatus, setGameStatus] = useState('setup');
            const [characters, setCharacters] = useState([]);
            const [stageTarget, setStageTarget] = useState(0);
            const [whackedPositions, setWhackedPositions] = useState([]);
            const [tapEffects, setTapEffects] = useState([]);
            const [bonusTexts, setBonusTexts] = useState([]);
            const [language, setLanguage] = useState('ko');
            
            const goodEmoji = "üáØüáµ";
            const badEmoji = "üá∞üá∑";
            
            const gameIntervalRef = useRef(null);
            const characterTimersRef = useRef({});
            const gameAreaRef = useRef(null);

            const texts = {
                ko: {
                    title: "üèùÔ∏è ÎèÖÎèÑ Î∞©Ïñ¥ Í≤åÏûÑ üèùÔ∏è",
                    score: "Ï†êÏàò",
                    timeLeft: "ÎÇ®ÏùÄ ÏãúÍ∞Ñ",
                    stage: "Ïä§ÌÖåÏù¥ÏßÄ",
                    clearCondition: "0Ï†ê Ïù¥ÏÉÅÏúºÎ°ú ÌÅ¥Î¶¨Ïñ¥",
                    current: "ÌòÑÏû¨",
                    max: "ÏµúÎåÄ",
                    gameReady: "Í≤åÏûÑ Ï§ÄÎπÑ ÏôÑÎ£å!",
                    startButton: "Í≤åÏûÑ ÏãúÏûë",
                    pressStart: "ÏïÑÎûò Î≤ÑÌäºÏùÑ ÎàåÎü¨ ÏãúÏûë",
                    stageCleared: "üéâ Ïä§ÌÖåÏù¥ÏßÄ ÌÅ¥Î¶¨Ïñ¥! üéâ",
                    stageClearMsg: "0Ï†ê Ïù¥ÏÉÅÏùÑ Ïú†ÏßÄÌïòÏó¨ ÌÅ¥Î¶¨Ïñ¥ÌñàÏäµÎãàÎã§!",
                    nextStage: "Îã§Ïùå Ïä§ÌÖåÏù¥ÏßÄÎ°ú",
                    allClear: "üèÜ Ï†ÑÏ≤¥ Ïä§ÌÖåÏù¥ÏßÄ ÌÅ¥Î¶¨Ïñ¥! üèÜ",
                    congratulations: "Ï∂ïÌïòÌï©ÎãàÎã§!",
                    gameOver: "üíÄ Í≤åÏûÑ Ïò§Î≤Ñ üíÄ",
                    timeUp: "ÏãúÍ∞Ñ Ï¢ÖÎ£å!",
                    zeroScore: "0Ï†êÏúºÎ°ú Í≤åÏûÑ Ïò§Î≤Ñ",
                    remaining: "ÎÇ®Ïùå",
                    reset: "Î¶¨ÏÖã",
                    howToPlay: "Í≤åÏûÑ Î∞©Î≤ï",
                    characters: "Ï∫êÎ¶≠ÌÑ∞:",
                    targetToHit: "Ï≤òÏπò ÎåÄÏÉÅ",
                    absoluteAvoid: "Ï†àÎåÄ ÌöåÌîº",
                    hitPoints: "+20~40Ï†ê / ÎÜìÏπòÎ©¥ -200Ï†ê",
                    instantZero: "Î∞üÏúºÎ©¥ Ï¶âÏãú 0Ï†ê",
                    rule1: "‚Ä¢ üáØüáµÎ•º Ï≤òÏπòÌïòÎ©¥ +20~40Ï†ê, ÎÜìÏπòÎ©¥ -200Ï†êÏùò ÎåÄÌè≠ Í∞êÏ†ê",
                    rule2: "‚Ä¢ üá∞üá∑Î•º Î∞üÏúºÎ©¥ Ï¶âÏãú 0Ï†ê (Ìïú Î∞©Ïóê Í≤åÏûÑ Ïò§Î≤Ñ)",
                    rule3: "‚Ä¢ Ï†êÏàòÍ∞Ä 0Ïù¥ ÎêòÎäî ÏàúÍ∞Ñ Í≤åÏûÑ Ïò§Î≤Ñ",
                    rule4: "‚Ä¢ Ïä§ÌÖåÏù¥ÏßÄÍ∞Ä Ïò¨ÎùºÍ∞àÏàòÎ°ù üáØüáµÏùò Ïù¥Îèô ÏÜçÎèÑÍ∞Ä Îπ®ÎùºÏßê",
                    rule5: "‚Ä¢ Ï†úÌïú ÏãúÍ∞ÑÏù¥ ÏßßÏïÑ Îß§Ïö∞ Ï†ÑÎûµÏ†ÅÏù∏ ÌîåÎ†àÏù¥ ÌïÑÏöî",
                    rule6: "‚Ä¢ Ï†úÌïú ÏãúÍ∞Ñ ÎÇ¥Ïóê Ï†êÏàòÍ∞Ä 1Ï†ê Ïù¥ÏÉÅ ÎÇ®ÏúºÎ©¥ Ïä§ÌÖåÏù¥ÏßÄ ÌÅ¥Î¶¨Ïñ¥",
                    bonusTexts: ["ÎåÄÌïúÎØºÍµ≠ ÎßåÏÑ∏", "ÏùºÎ≥∏ Ï£ΩÏñ¥Îùº", "ÏÇ¨Ïä§Í∞Ä", "Ïµ∏ÏïÑ", "ÎßåÏÑ∏"]
                },
                ja: {
                    title: "üèùÔ∏è Áã¨Â≥∂Èò≤Ë°õ„Ç≤„Éº„É† üèùÔ∏è",
                    score: "„Çπ„Ç≥„Ç¢",
                    timeLeft: "ÊÆã„ÇäÊôÇÈñì",
                    stage: "„Çπ„ÉÜ„Éº„Ç∏",
                    clearCondition: "0ÁÇπ‰ª•‰∏ä„Åß„ÇØ„É™„Ç¢",
                    current: "ÁèæÂú®",
                    max: "MAX",
                    gameReady: "„Ç≤„Éº„É†Ê∫ñÂÇôÂÆå‰∫ÜÔºÅ",
                    startButton: "„Ç≤„Éº„É†ÈñãÂßã",
                    pressStart: "‰∏ã„ÅÆ„Éú„Çø„É≥„ÇíÊäº„Åó„Å¶„Çπ„Çø„Éº„Éà",
                    stageCleared: "üéâ „Çπ„ÉÜ„Éº„Ç∏„ÇØ„É™„Ç¢ÔºÅ üéâ",
                    stageClearMsg: "0ÁÇπ‰ª•‰∏ä„ÇíÁ∂≠ÊåÅ„Åó„Å¶„ÇØ„É™„Ç¢„Åó„Åæ„Åó„ÅüÔºÅ",
                    nextStage: "Ê¨°„ÅÆ„Çπ„ÉÜ„Éº„Ç∏„Å∏",
                    allClear: "üèÜ ÂÖ®„Çπ„ÉÜ„Éº„Ç∏„ÇØ„É™„Ç¢ÔºÅ üèÜ",
                    congratulations: "„Åä„ÇÅ„Åß„Å®„ÅÜ„Åî„Åñ„ÅÑ„Åæ„ÅôÔºÅ",
                    gameOver: "üíÄ „Ç≤„Éº„É†„Ç™„Éº„Éê„Éº üíÄ",
                    timeUp: "ÊôÇÈñìÂàá„ÇåÔºÅ",
                    zeroScore: "„Çπ„Ç≥„Ç¢0ÁÇπ„Åß„Ç≤„Éº„É†„Ç™„Éº„Éê„Éº",
                    remaining: "ÊÆã„Çä",
                    reset: "„É™„Çª„ÉÉ„Éà",
                    howToPlay: "„Ç≤„Éº„É†„ÅÆÈÅä„Å≥Êñπ",
                    characters: "„Ç≠„É£„É©„ÇØ„Çø„Éº:",
                    targetToHit: "Ë®é„Å°Âèñ„ÇãÂØæË±°",
                    absoluteAvoid: "Áµ∂ÂØæÈÅø„Åë„Çã",
                    hitPoints: "+20~40ÁÇπ / ÈÄÉ„Åô„Å®-200ÁÇπ",
                    instantZero: "Ë∏è„ÇÄ„Å®Âç≥Â∫ß„Å´0ÁÇπ",
                    rule1: "‚Ä¢ üáØüáµ„ÇíË®é„Å°Âèñ„Çã„Å®+20~40ÁÇπ„ÄÅÈÄÉ„Åô„Å®-200ÁÇπ„ÅÆÂ§ßÂπÖÊ∏õÁÇπ",
                    rule2: "‚Ä¢ üá∞üá∑„ÇíË∏è„ÇÄ„Å®Âç≥Â∫ß„Å´0ÁÇπÔºà‰∏ÄÁô∫„Ç≤„Éº„É†„Ç™„Éº„Éê„ÉºÔºâ",
                    rule3: "‚Ä¢ „Çπ„Ç≥„Ç¢„Åå0„Å´„Å™„Å£„ÅüÁû¨Èñì„Å´„Ç≤„Éº„É†„Ç™„Éº„Éê„Éº",
                    rule4: "‚Ä¢ „Çπ„ÉÜ„Éº„Ç∏„Åå‰∏ä„Åå„Çã„Å´„Å§„Çå„Å¶üáØüáµ„ÅÆÁßªÂãïÈÄüÂ∫¶„Åå‰∏ä„Åå„Çã",
                    rule5: "‚Ä¢ Âà∂ÈôêÊôÇÈñì„ÅåÁü≠„Åè„ÄÅÈùûÂ∏∏„Å´Êà¶Áï•ÁöÑ„Å™„Éó„É¨„Ç§„ÅåÂøÖË¶Å",
                    rule6: "‚Ä¢ Âà∂ÈôêÊôÇÈñìÂÜÖ„Å´„Çπ„Ç≥„Ç¢„Åå1ÁÇπ‰ª•‰∏äÊÆã„Çå„Å∞„Çπ„ÉÜ„Éº„Ç∏„ÇØ„É™„Ç¢",
                    bonusTexts: ["ÔæÉÔæäÔæùÔæêÔæùÔΩ∏ÔæûÔΩ∏ÔæèÔæùÔΩæ", "ÔΩ≤ÔæôÔæéÔæûÔæùÔæÅÔΩ≠ÔΩ∫ÔæûÔæó", "ÔΩªÔΩΩÔΩ∂Ôæû", "ÔæÅÔΩÆÔΩ±", "ÔæèÔæùÔΩæ"]
                }
            };

            const t = texts[language];

            const stageConfig = {
                1: { startScore: 500, maxScore: 1000, time: 20, spawnRate: 1000, maxCharacters: 6 },
                2: { startScore: 700, maxScore: 1400, time: 25, spawnRate: 900, maxCharacters: 8 },
                3: { startScore: 900, maxScore: 1800, time: 30, spawnRate: 800, maxCharacters: 10 },
                4: { startScore: 1100, maxScore: 2200, time: 35, spawnRate: 700, maxCharacters: 12 },
                5: { startScore: 1300, maxScore: 2600, time: 40, spawnRate: 600, maxCharacters: 15 }
            };

            const getRandomPosition = () => {
                const margin = 50;
                const x = Math.random() * (400 - margin * 2) + margin;
                const y = Math.random() * (400 - margin * 2) + margin;
                return { x, y };
            };

            const moveCharacter = (characterId) => {
                setCharacters(prev => prev.map(char => {
                    if (char.id === characterId) {
                        const newPosition = getRandomPosition();
                        return { ...char, ...newPosition };
                    }
                    return char;
                }));
            };

            const continuousMove = (characterId) => {
                const moveStep = () => {
                    setCharacters(prev => prev.map(char => {
                        if (char.id === characterId && char.type === 'bad') {
                            const deltaX = (Math.random() - 0.5) * 30;
                            const deltaY = (Math.random() - 0.5) * 30;
                            
                            const margin = 50;
                            const newX = Math.max(margin, Math.min(350, char.x + deltaX));
                            const newY = Math.max(margin, Math.min(350, char.y + deltaY));
                            
                            return { ...char, x: newX, y: newY };
                        }
                        return char;
                    }));
                };
                return setInterval(moveStep, 100);
            };

            const spawnCharacter = () => {
                const config = stageConfig[stage];
                if (characters.length >= config.maxCharacters) return;

                const isGoodCharacter = Math.random() > 0.5;
                const points = isGoodCharacter ? Math.floor(Math.random() * 20) + 20 : 0;
                const position = getRandomPosition();
                const newCharacter = {
                    id: Date.now() + Math.random(),
                    type: isGoodCharacter ? 'good' : 'bad',
                    points,
                    ...position,
                    createdAt: Date.now()
                };

                setCharacters(prev => [...prev, newCharacter]);

                let moveTimer, continuousTimer;

                if (isGoodCharacter) {
                    const baseSpeed = 800 - (stage - 1) * 150;
                    const randomVariation = Math.random() * 200;
                    const moveSpeed = Math.max(200, baseSpeed + randomVariation);
                    
                    moveTimer = setInterval(() => {
                        if (gameStatus === 'playing') {
                            moveCharacter(newCharacter.id);
                        }
                    }, moveSpeed);
                } else {
                    continuousTimer = continuousMove(newCharacter.id);
                }

                const removeTimer = setTimeout(() => {
                    setCharacters(prev => {
                        const character = prev.find(char => char.id === newCharacter.id);
                        if (character && character.type === 'good') {
                            setScore(current => Math.max(0, current - 200));
                        }
                        return prev.filter(char => char.id !== newCharacter.id);
                    });
                    if (moveTimer) clearInterval(moveTimer);
                    if (continuousTimer) clearInterval(continuousTimer);
                }, isGoodCharacter ? 4000 + Math.random() * 2000 : 10000 + Math.random() * 5000);

                characterTimersRef.current[newCharacter.id] = { 
                    moveInterval: moveTimer || continuousTimer, 
                    removeTimer 
                };
            };

            const catchCharacter = (character) => {
                if (gameStatus !== 'playing') return;

                const hitEffect = { x: character.x, y: character.y, id: Date.now() };
                setWhackedPositions(prev => [...prev, hitEffect]);
                
                setTimeout(() => {
                    setWhackedPositions(prev => prev.filter(pos => pos.id !== hitEffect.id));
                }, 600);

                if (character.type === 'good') {
                    const config = stageConfig[stage];
                    const newScore = Math.min(config.maxScore, score + character.points);
                    setScore(newScore);
                    
                    const randomText = t.bonusTexts[Math.floor(Math.random() * t.bonusTexts.length)];
                    
                    const appearTime = Date.now() - character.createdAt;
                    if (appearTime < 1000) {
                        const bonusTextEffect = { 
                            x: character.x, 
                            y: character.y - 50, 
                            id: Date.now() + Math.random(),
                            text: randomText
                        };
                        setBonusTexts(prev => [...prev, bonusTextEffect]);
                        
                        setTimeout(() => {
                            setBonusTexts(prev => prev.filter(bonus => bonus.id !== bonusTextEffect.id));
                        }, 1500);
                    }
                } else {
                    setScore(0);
                }

                setCharacters(prev => prev.filter(char => char.id !== character.id));

                if (characterTimersRef.current[character.id]) {
                    clearInterval(characterTimersRef.current[character.id].moveInterval);
                    clearTimeout(characterTimersRef.current[character.id].removeTimer);
                    delete characterTimersRef.current[character.id];
                }
            };

            const handleGameAreaClick = (event) => {
                if (gameStatus !== 'playing') return;

                const rect = gameAreaRef.current.getBoundingClientRect();
                const x = event.clientX - rect.left;
                const y = event.clientY - rect.top;

                const tapEffect = { x, y, id: Date.now() + Math.random() };
                setTapEffects(prev => [...prev, tapEffect]);
                
                setTimeout(() => {
                    setTapEffects(prev => prev.filter(effect => effect.id !== tapEffect.id));
                }, 500);
            };

            const startGame = () => {
                const config = stageConfig[stage];
                setScore(config.startScore);
                setTimeLeft(config.time);
                setStageTarget(0);
                setGameStatus('playing');

                gameIntervalRef.current = setInterval(() => {
                    setTimeLeft(prev => {
                        if (prev <= 1) {
                            setGameStatus('gameOver');
                            return 0;
                        }
                        return prev - 1;
                    });
                }, 1000);
            };

            const resetGame = () => {
                setScore(500);
                setStage(1);
                setCharacters([]);
                setWhackedPositions([]);
                setTapEffects([]);
                setBonusTexts([]);
                setGameStatus('setup');
                if (gameIntervalRef.current) {
                    clearInterval(gameIntervalRef.current);
                }
                Object.values(characterTimersRef.current).forEach(timers => {
                    clearInterval(timers.moveInterval);
                    clearTimeout(timers.removeTimer);
                });
                characterTimersRef.current = {};
            };

            const nextStage = () => {
                setStage(prev => prev + 1);
                setCharacters([]);
                setWhackedPositions([]);
                setTapEffects([]);
                setBonusTexts([]);
                setGameStatus('setup');
                if (gameIntervalRef.current) {
                    clearInterval(gameIntervalRef.current);
                }
                Object.values(characterTimersRef.current).forEach(timers => {
                    clearInterval(timers.moveInterval);
                    clearTimeout(timers.removeTimer);
                });
                characterTimersRef.current = {};
            };

            useEffect(() => {
                let spawnInterval;
                
                if (gameStatus === 'playing') {
                    const config = stageConfig[stage];
                    spawnInterval = setInterval(() => {
                        spawnCharacter();
                    }, config.spawnRate);
                }

                return () => {
                    if (spawnInterval) {
                        clearInterval(spawnInterval);
                    }
                };
            }, [gameStatus, stage, characters.length]);

            useEffect(() => {
                if (gameStatus === 'gameOver') {
                    if (gameIntervalRef.current) {
                        clearInterval(gameIntervalRef.current);
                    }
                    Object.values(characterTimersRef.current).forEach(timers => {
                        clearInterval(timers.moveInterval);
                        clearTimeout(timers.removeTimer);
                    });
                    characterTimersRef.current = {};

                    if (score > 0) {
                        setGameStatus('stageCleared');
                    }
                }
            }, [gameStatus, score]);

            useEffect(() => {
                if (gameStatus === 'playing' && score <= 0) {
                    setGameStatus('gameOver');
                }
            }, [score, gameStatus]);

            return (
                <div className="min-h-screen bg-gradient-to-b from-green-800 to-green-900 p-4">
                    <div className="max-w-4xl mx-auto">
                        <div className="bg-white rounded-lg shadow-lg p-6 mb-6">
                            <div className="flex justify-between items-center mb-4">
                                <h1 className="text-3xl font-bold text-center text-green-700 flex-1">
                                    {t.title}
                                </h1>
                                <div className="flex gap-2">
                                    <button
                                        onClick={() => setLanguage('ko')}
                                        className={`px-3 py-1 rounded text-sm font-bold transition-colors ${
                                            language === 'ko' 
                                                ? 'bg-blue-500 text-white' 
                                                : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                                        }`}
                                    >
                                        ÌïúÍµ≠Ïñ¥
                                    </button>
                                    <button
                                        onClick={() => setLanguage('ja')}
                                        className={`px-3 py-1 rounded text-sm font-bold transition-colors ${
                                            language === 'ja' 
                                                ? 'bg-blue-500 text-white' 
                                                : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                                        }`}
                                    >
                                        Êó•Êú¨Ë™û
                                    </button>
                                </div>
                            </div>
                            
                            <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                                <div className="bg-blue-100 p-3 rounded-lg">
                                    <div className="text-2xl font-bold text-blue-600">{score}</div>
                                    <div className="text-sm text-blue-500">{t.score}</div>
                                </div>
                                <div className="bg-purple-100 p-3 rounded-lg">
                                    <div className="text-2xl font-bold text-purple-600">{timeLeft}</div>
                                    <div className="text-sm text-purple-500">{t.timeLeft}</div>
                                </div>
                                <div className="bg-yellow-100 p-3 rounded-lg">
                                    <div className="text-2xl font-bold text-yellow-600">{t.stage} {stage}</div>
                                    <div className="text-sm text-yellow-500">{t.clearCondition}</div>
                                </div>
                            </div>

                            <div className="bg-gray-200 rounded-full h-6 relative overflow-hidden mb-2">
                                <div 
                                    className={`h-full rounded-full transition-all duration-500 ease-out relative ${
                                        score > stageConfig[stage].maxScore * 0.7 ? 'bg-gradient-to-r from-green-400 to-green-600' : 
                                        score > stageConfig[stage].maxScore * 0.4 ? 'bg-gradient-to-r from-yellow-400 to-yellow-600' : 
                                        'bg-gradient-to-r from-red-400 to-red-600'
                                    }`}
                                    style={{ width: `${Math.min((score / stageConfig[stage].maxScore) * 100, 100)}%` }}
                                >
                                    <div className="absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent animate-pulse"></div>
                                </div>
                                <div className="absolute top-0 left-0 w-1 h-full bg-red-700"></div>
                                <div className="absolute top-0 right-0 w-1 h-full bg-yellow-500"></div>
                            </div>
                            <div className="flex justify-between text-sm text-gray-600">
                                <span>{t.current}: {score}Ï†ê</span>
                                <span className="text-yellow-600">{t.max}: {stageConfig[stage].maxScore}Ï†ê</span>
                            </div>
                        </div>

                        <div className="bg-white rounded-lg shadow-lg p-6 mb-6">
                            <div 
                                ref={gameAreaRef}
                                className="relative w-full h-96 bg-gradient-to-b from-green-600 to-green-700 rounded-lg border-4 border-green-800 overflow-hidden"
                                style={{ userSelect: 'none' }}
                                onClick={handleGameAreaClick}
                            >
                                <div className="absolute top-4 left-1/2 transform -translate-x-1/2 text-6xl font-bold text-green-900 opacity-30 pointer-events-none z-0">
                                    ÎèÖÎèÑ
                                </div>
                                
                                {characters.map((character) => (
                                    <div
                                        key={character.id}
                                        className={`absolute cursor-pointer transform -translate-x-1/2 -translate-y-1/2 hover:scale-110 ${
                                            character.type === 'good' 
                                                ? 'transition-all duration-300 ease-out'
                                                : 'transition-all duration-1000 ease-in-out'
                                        }`}
                                        style={{ 
                                            left: `${character.x}px`, 
                                            top: `${character.y}px`,
                                            zIndex: 10
                                        }}
                                        onClick={(e) => {
                                            e.stopPropagation();
                                            catchCharacter(character);
                                        }}
                                    >
                                        <div className={`text-4xl ${
                                            character.type === 'good' 
                                                ? 'animate-bounce'
                                                : 'animate-pulse'
                                        }`}>
                                            {character.type === 'good' ? goodEmoji : badEmoji}
                                        </div>
                                    </div>
                                ))}

                                {tapEffects.map((effect) => (
                                    <div
                                        key={effect.id}
                                        className="absolute transform -translate-x-1/2 -translate-y-1/2 pointer-events-none"
                                        style={{ 
                                            left: `${effect.x}px`, 
                                            top: `${effect.y}px`,
                                            zIndex: 5
                                        }}
                                    >
                                        <div className="text-4xl opacity-80 animate-bounce">üëü</div>
                                    </div>
                                ))}

                                {whackedPositions.map((pos) => (
                                    <div
                                        key={pos.id}
                                        className="absolute transform -translate-x-1/2 -translate-y-1/2 pointer-events-none"
                                        style={{ 
                                            left: `${pos.x}px`, 
                                            top: `${pos.y}px`,
                                            zIndex: 20
                                        }}
                                    >
                                        <div className="text-5xl opacity-90 animate-ping">üí•</div>
                                    </div>
                                ))}

                                {bonusTexts.map((bonus) => (
                                    <div
                                        key={bonus.id}
                                        className="absolute transform -translate-x-1/2 -translate-y-1/2 pointer-events-none"
                                        style={{ 
                                            left: `${bonus.x}px`, 
                                            top: `${bonus.y}px`,
                                            zIndex: 25
                                        }}
                                    >
                                        <div className="text-2xl font-bold text-yellow-400 animate-bounce drop-shadow-lg">
                                            {bonus.text}
                                        </div>
                                    </div>
                                ))}

                                {gameStatus === 'setup' && (
                                    <div className="absolute inset-0 flex items-center justify-center bg-black bg-opacity-50 rounded-lg">
                                        <div className="text-center text-white bg-black bg-opacity-70 p-6 rounded-lg">
                                            <div className="text-4xl mb-4">üéÆ</div>
                                            <div className="font-bold text-xl mb-2">{t.gameReady}</div>
                                            <div className="text-sm">{t.pressStart}</div>
                                        </div>
                                    </div>
                                )}

                                {(gameStatus === 'gameOver' || gameStatus === 'stageCleared') && (
                                    <div className="absolute inset-0 flex items-center justify-center bg-black bg-opacity-70 rounded-lg">
                                        <div className="text-center text-white bg-black bg-opacity-80 p-8 rounded-lg max-w-sm">
                                            {gameStatus === 'stageCleared' ? (
                                                <div>
                                                    <h3 className="text-3xl font-bold text-green-400 mb-4">{t.stageCleared}</h3>
                                                    <p className="mb-6 text-lg">{t.stageClearMsg}</p>
                                                    <div className="flex flex-col gap-3">
                                                        {stage < 5 ? (
                                                            <button
                                                                onClick={nextStage}
                                                                className="bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-lg font-bold transition-colors text-lg"
                                                            >
                                                                {t.nextStage}
                                                            </button>
                                                        ) : (
                                                            <div>
                                                                <h3 className="text-2xl font-bold text-yellow-400 mb-4">{t.allClear}</h3>
                                                                <p className="mb-4">{t.congratulations}</p>
                                                            </div>
                                                        )}
                                                        <button
                                                            onClick={resetGame}
                                                            className="bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded-lg font-bold flex items-center justify-center gap-2 transition-colors"
                                                        >
                                                            <RotateCcw size={20} />
                                                            {t.reset}
                                                        </button>
                                                    </div>
                                                </div>
                                            ) : (
                                                <div>
                                                    <h3 className="text-3xl font-bold text-red-400 mb-4">{t.gameOver}</h3>
                                                    <p className="mb-6 text-lg">
                                                        {score > 0 
                                                            ? `${t.timeUp} ${t.remaining} ${score}Ï†ê` 
                                                            : t.zeroScore
                                                        }
                                                    </p>
                                                    <div className="flex flex-col gap-3">
                                                        {score > 0 && stage < 5 && (
                                                            <button
                                                                onClick={nextStage}
                                                                className="bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-lg font-bold transition-colors text-lg"
                                                            >
                                                                {t.nextStage}
                                                            </button>
                                                        )}
                                                        <button
                                                            onClick={resetGame}
                                                            className="bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded-lg font-bold flex items-center justify-center gap-2 transition-colors"
                                                        >
                                                            <RotateCcw size={20} />
                                                            {t.reset}
                                                        </button>
                                                    </div>
                                                </div>
                                            )}
                                        </div>
                                    </div>
                                )}
                            </div>

                            <div className="flex justify-center gap-4 mt-4">
                                {gameStatus === 'setup' && (
                                    <button
                                        onClick={startGame}
                                        className="bg-green-500 hover:bg-green-600 text-white px-6 py-3 rounded-lg font-bold flex items-center gap-2 transition-colors"
                                    >
                                        <Play size={20} />
                                        {t.startButton}
                                    </button>
                                )}
                            </div>
                        </div>

                        <div className="bg-white rounded-lg shadow-lg p-6">
                            <h3 className="font-bold mb-2">{t.howToPlay}</h3>
                            <div className="mb-4 p-3 bg-blue-50 rounded-lg">
                                <p className="text-sm text-blue-700 font-semibold mb-2">{t.characters}</p>
                                <div className="flex justify-center gap-8">
                                    <div className="text-center">
                                        <div className="text-3xl mb-1">üáØüáµ</div>
                                        <div className="text-xs text-blue-600 font-semibold">{t.targetToHit}</div>
                                        <div className="text-xs text-gray-500">{t.hitPoints}</div>
                                    </div>
                                    <div className="text-center">
                                        <div className="text-3xl mb-1">üá∞üá∑</div>
                                        <div className="text-xs text-red-600 font-semibold">{t.absoluteAvoid}</div>
                                        <div className="text-xs text-gray-500">{t.instantZero}</div>
                                    </div>
                                </div>
                            </div>
                            <ul className="text-sm text-gray-700 space-y-1">
                                <li>{t.rule1}</li>
                                <li>{t.rule2}</li>
                                <li>{t.rule3}</li>
                                <li>{t.rule4}</li>
                                <li>{t.rule5}</li>
                                <li>{t.rule6}</li>
                            </ul>
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(React.createElement(DokdoDefenseGame));
    </script>
</body>
</html>
